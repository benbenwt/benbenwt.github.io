# 基本

>linux操作系统由4部分组成：内核：kernel，shell，文件系统和应用程序。
>
>linux内核由五个子系统组成：进程调度，内存管理，虚拟文件系统，网络接口，进程间通信。io系统，磁盘等。

# 内存寻址

	### 内存地址

##### 逻辑地址：在分段结构中使用，使用一个segment段和一个offset偏移量表示，offset表示断开始到实际地址的距离。

##### 线性地址：32位无符号整数，表示一段地址可高达4GB，将逻辑地址加上基地址就是线性地址。

##### 物理地址：芯片级内存单元寻址，与电信号对应。

cpu控制单元通过分段单元将逻辑地址转为线性地址，通过分页单元将线性地址转为物理地址。

### 硬件分段单元

>一个逻辑地址由一段标识符和一个指定段内相对地址的偏移量。

为了快速检索段选择符：段标识符，处理器用段寄存器存放段选择符。共有6个：cs,ss,ds,es,fs,gs.

其中三个有特殊用途：
cs 代码寄存器

ss 栈段寄存器，指向存放当前程序栈的段。

ds 数据段寄存器，存放静态数据和外部数据的段。

### 段描述符

每个段描述符表示，村塾段的特征，存在全局描述符表中或局部描述符表。

组成：1type域：米哦啊书段的类型2s，表示是否为系统段。3第一个字节的线性地址，用于地址转化。

### 段选择符

当选择符被装入段寄存器，相应的段描述符装入cpu寄存器。这个段的逻辑地址转换不必查找gdt和ldt，直接在寄存器中。

组成：1索引，在gdt或ldt中入口2在ldt还是gdt3段选择符放入cs时优先级

### 段选择符和段描述符

段描述符8字节，段选择符16位长。

段选择符高13位乘以8得到在ldt或gdt中相对地址，因为选择符前13位为索引。

例：gdt起始地址a，段选择符索引号2，则在gdt实际地址=a+相对地址:2*8

### 段单元

逻辑地址转为线性地址

1找到描述符表

2取出索引号，求出描述符在gdt地址。

3根据段描述符域基地址和逻辑地址偏移量求出线性地址。

### 硬件中的分页单元

>将线性地址转为物理地址分为两步，第一步使用的转换表称为页目录，第二种使用的称为页表。
>
>正在使用的页目录表的物理地址放在cr3中，线性地址的目录域决定指向页目录表哪一项，即指向哪个页表。随后，页表域决定页表的一项，此项包含页框所在物理地址。偏移量决定本页框内相对位置。

目录和页表域都10位长，组成:

### 拓展分页

将页框大小设为4kb或4mb，4mb页目录表项的地址低22位无效。4kb低12位无效。使用page size标识大小。

### 硬件保护方案

段有读写执行三种权限，页只有读写。

分页举例